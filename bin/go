#!/bin/bash

# A shell script to jump to a directory matching what is typed as the first
# argument

if [ -z "$1" ]; then
  cd
  return 0
fi

# Improve this line to handle '\$1' as expected
files="`locate -b $1`"

old_IFS=$IFS
IFS='
'
target=""
# Choose the first line as our target
for k in $files; do
  if [ -d "$k" ]; then
    target="$k"
    break
  fi
done

if [ -z "$target" ]; then
  echo "Error: '$1' did not match any directories" >&2
  return 2
fi

IFS=$old_IFS

cd "$target" || return $?
pwd
